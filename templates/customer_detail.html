<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="vie        .customer-systems {
            grid-area: systems;
            background-color: white;
            border-radius: 8px;
            padding: 1.5rem;
            box-shadow: 0 2px 6px rgba(0,0,0,0.05);
        }
        
        .query-section-full-width {
            width: 100%;
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 6px rgba(0,0,0,0.05);
            margin: 30px 0;
            max-width: 1200px;
        } content="width=device-width, initial-scale=1.0">
    <title>{{ customer.name }} - 客户详情 - DCAM</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            background: #f5f7fa;
            min-height: 100vh;
        }
        
        .header {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 50%, #dee2e6 100%);
            padding: 1.5rem 0;
            color: #2d3748;
            text-align: center;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            position: relative;
            overflow: hidden;
        }
        
        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 20"><defs><radialGradient id="a" cx="50%" cy="0%" r="100%"><stop offset="0%" stop-color="%23cf2e2e" stop-opacity=".05"/><stop offset="100%" stop-color="%23cf2e2e" stop-opacity="0"/></radialGradient></defs><rect width="100" height="20" fill="url(%23a)"/></svg>');
            opacity: 0.6;
        }
        
        .header-content {
            position: relative;
            z-index: 2;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-wrap: wrap;
            gap: 1rem;
        }
        
        .logo-container {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .ddn-logo {
            height: 50px;
            width: auto;
            filter: none;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        .navigation {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }
        
        .breadcrumb {
            display: flex;
            gap: 0.5rem;
            align-items: center;
        }
        
        .breadcrumb a {
            color: #667eea;
            text-decoration: none;
        }
        
        .breadcrumb a:hover {
            text-decoration: underline;
        }
        
        .breadcrumb .separator {
            color: #a0aec0;
        }
        
        h1 {
            color: #2d3748;
            margin-bottom: 0.5rem;
            font-size: 2.2em;
        }
        
        h2 {
            color: #2d3748;
            font-size: 1.8rem;
            margin-bottom: 1rem;
        }
        
        .subtitle {
            color: #4a5568;
            font-size: 1.1em;
        }
        
        .customer-top-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin-top: 1.5rem;
        }
        
        .customer-info {
            background: white;
            border-radius: 10px;
            padding: 1.5rem;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }
        
        .customer-systems {
            background: white;
            border-radius: 10px;
            padding: 1.5rem;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }
        
        .info-item {
            margin-bottom: 1.5rem;
        }
        
        .info-label {
            font-size: 0.9rem;
            color: #718096;
            margin-bottom: 0.3rem;
        }
        
        .info-value {
            font-size: 1.1rem;
            color: #2d3748;
        }
        
        .info-value.empty {
            color: #a0aec0;
            font-style: italic;
        }
        
        .description {
            padding: 1rem;
            background: #f7fafc;
            border-radius: 5px;
            color: #4a5568;
            margin-top: 0.5rem;
        }
        
        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 500;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .btn-primary {
            background: #667eea;
            color: white;
        }
        
        .btn-primary:hover {
            background: #5a6fd8;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }
        
        .btn-secondary {
            background: #f7fafc;
            color: #4a5568;
            border: 1px solid #e2e8f0;
        }
        
        .btn-secondary:hover {
            background: #edf2f7;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(226, 232, 240, 0.5);
        }
        
        .customer-actions {
            margin-top: 1.5rem;
            display: flex;
            gap: 1rem;
        }
        
        .system-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }
        
        .system-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: #2d3748;
        }
        
        .system-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .system-table th, .system-table td {
            padding: 0.75rem 1rem;
            text-align: left;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .system-table th {
            background: #f7fafc;
            color: #4a5568;
            font-weight: 600;
        }
        
        .system-table tbody tr:hover {
            background: #f7fafc;
        }
        
        .system-table a {
            color: #3182ce;
            text-decoration: none;
        }
        
        .system-table a:hover {
            text-decoration: underline;
        }
        
        .empty-systems {
            text-align: center;
            padding: 2rem;
            color: #a0aec0;
        }
        
        .status-badge {
            display: inline-block;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: 500;
        }
        
        .status-created {
            background: #e2e8f0;
            color: #4a5568;
        }
        
        .status-imported {
            background: #c6f6d5;
            color: #2f855a;
        }
        
        @media (max-width: 768px) {
            .customer-top-section {
                grid-template-columns: 1fr;
            }
            
            .query-section-full-width form > div {
                grid-template-columns: 1fr !important;
                gap: 15px !important;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-content">
            <div class="logo-container">
                <img src="{{ url_for('static', filename='DDN-main-logo.svg') }}" alt="DDN Logo" class="ddn-logo">
                <div>
                    <h1>🏢 DCAM</h1>
                    <p class="subtitle">DDN客户资产管理系统</p>
                </div>
            </div>
        </div>
    </div>
    
    <div class="container">
        <div class="navigation">
            <div class="breadcrumb">
                <a href="{{ url_for('index') }}">首页</a>
                <span class="separator">/</span>
                <a href="{{ url_for('customers_list') }}">客户管理</a>
                <span class="separator">/</span>
                <span>{{ customer.name }}</span>
            </div>
        </div>
        
        <div class="customer-top-section">
            <div class="customer-info">
                <h2>客户信息</h2>
                
                <div class="info-item">
                    <div class="info-label">客户名称</div>
                    <div class="info-value">{{ customer.name }}</div>
                </div>
                
                <div class="info-item">
                    <div class="info-label">联系人</div>
                    <div class="info-value {% if not customer.contact %}empty{% endif %}">
                        {{ customer.contact or '未设置' }}
                    </div>
                </div>
                
                <div class="info-item">
                    <div class="info-label">联系邮箱</div>
                    <div class="info-value {% if not customer.email %}empty{% endif %}">
                        {{ customer.email or '未设置' }}
                    </div>
                </div>
                
                <div class="info-item">
                    <div class="info-label">创建时间</div>
                    <div class="info-value">
                        {{ customer.created_at|datetime }}
                    </div>
                </div>
                
                {% if customer.description %}
                <div class="info-item">
                    <div class="info-label">描述</div>
                    <div class="description">{{ customer.description }}</div>
                </div>
                {% endif %}
                
                <div class="customer-actions">
                    <a href="{{ url_for('edit_customer', customer_id=customer_id) }}" class="btn btn-secondary">
                        <span class="icon">✏️</span>
                        编辑客户
                    </a>
                </div>
            </div>
            
            <div class="customer-systems">
                <div class="system-header">
                    <h2 class="system-title">客户系统</h2>
                    <a href="{{ url_for('new_system') }}?customer_id={{ customer_id }}" class="btn btn-primary">
                        <span class="icon">➕</span>
                        添加系统
                    </a>
                </div>
                
                {% if systems %}
                    <table class="system-table">
                        <thead>
                            <tr>
                                <th>系统名称</th>
                                <th>状态</th>
                                <th>创建时间</th>
                                <th>操作</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for system_id, system in systems.items() %}
                                <tr>
                                    <td>
                                        <a href="{{ url_for('system_detail', system_id=system_id) }}">
                                            {{ system.name }}
                                        </a>
                                    </td>
                                    <td>
                                        {% if system.status == 'created' %}
                                            <span class="status-badge status-created">已创建</span>
                                        {% elif system.status == 'imported' %}
                                            <span class="status-badge status-imported">已导入</span>
                                        {% else %}
                                            <span class="status-badge">{{ system.status }}</span>
                                        {% endif %}
                                    </td>
                                    <td>{{ system.created_at|datetime }}</td>
                                    <td>
                                        <a href="{{ url_for('system_detail', system_id=system_id) }}">查看</a>
                                        {% if system.status == 'created' %}
                                         | <a href="{{ url_for('import_config', system_id=system_id) }}">导入配置</a>
                                        {% endif %}
                                    </td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                {% else %}
                    <div class="empty-systems">
                        该客户暂无系统，点击"添加系统"开始创建
                    </div>
                {% endif %}
            </div>
        </div>
        
        <!-- 客户快速查询接口 - 独立全宽模块 -->
        <div class="query-section-full-width">
                <h2 style="margin-bottom: 15px; color: #4a5568;">客户资产快速查询</h2>
                
                <form id="customerQueryForm" style="margin-bottom: 20px;">
                    <input type="hidden" id="customer_id" value="{{ customer_id }}">
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; margin-bottom: 15px; width: 100%;">
                        <div>
                            <label style="display: block; margin-bottom: 8px; color: #4a5568; font-weight: 500;">资产所有者</label>
                            <input type="text" value="{{ customer.name }}" disabled style="width: 100%; padding: 12px; border-radius: 6px; border: 1px solid #e2e8f0; background-color: #f8f9fa; color: #718096; box-sizing: border-box;">
                            <input type="hidden" id="asset_owner" name="asset_owner" value="{{ customer.name }}">
                        </div>
                        
                        <div>
                            <label style="display: block; margin-bottom: 8px; color: #4a5568; font-weight: 500;">系统</label>
                            <select id="system_id" name="system_id" style="width: 100%; padding: 12px; border-radius: 6px; border: 1px solid #e2e8f0; box-sizing: border-box;">
                                <option value="">所有系统</option>
                                {% for system_id, system in systems.items() %}
                                <option value="{{ system_id }}">{{ system.name }}</option>
                                {% endfor %}
                            </select>
                        </div>
                        
                        <div>
                            <label style="display: block; margin-bottom: 8px; color: #4a5568; font-weight: 500;">查询类型</label>
                            <select id="query_type" name="query_type" required style="width: 100%; padding: 12px; border-radius: 6px; border: 1px solid #e2e8f0; box-sizing: border-box;">
                                <option value="">请选择查询类型</option>
                                <option value="0">所有查询</option>
                                <option value="1">设备数量统计</option>
                                <option value="2">SFA版本详情</option>
                                <option value="3">EXA版本详情</option>
                                <option value="4">BBU过期日期计算</option>
                                <option value="5">集群容量查询</option>
                                <option value="6">设备序列号查询</option>
                                <option value="7">集群IP地址查询</option>
                            </select>
                        </div>
                    </div>
                    
                    <button type="submit" class="btn btn-primary" style="width: 100%;">
                        <span class="icon">🔍</span>
                        执行查询
                    </button>
                </form>
                
                <div id="customer-query-results" style="display: none; margin-top: 20px;">
                    <div style="background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 6px; padding: 15px; margin-bottom: 10px;">
                        <h4 style="margin: 0; color: #4a5568;">查询结果</h4>
                    </div>
                    <div id="customer-results-container" style="overflow-x: auto;">
                        <!-- 查询结果将在此显示 -->
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script type="text/javascript">
        // 日期格式化函数
        document.addEventListener('DOMContentLoaded', function() {
            const dateElements = document.querySelectorAll('.info-value, td');
            dateElements.forEach(element => {
                const text = element.textContent.trim();
                if (text && text.match(/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}/)) {
                    try {
                        const date = new Date(text);
                        element.textContent = date.toLocaleDateString('zh-CN') + ' ' + 
                                              date.toLocaleTimeString('zh-CN', {hour: '2-digit', minute:'2-digit'});
                    } catch (e) {
                        console.error('日期格式化错误', e);
                    }
                }
            });
            
            // 客户快速查询功能
            const customerQueryForm = document.getElementById('customerQueryForm');
            if (customerQueryForm) {
                console.log('找到客户查询表单，添加提交事件监听器');
                customerQueryForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    console.log('表单提交被触发');
                    
                    // 获取表单数据
                    const queryTypeElement = document.getElementById('query_type');
                    const assetOwnerElement = document.getElementById('asset_owner');
                    const systemIdElement = document.getElementById('system_id');
                    
                    if (!queryTypeElement || !queryTypeElement.value) {
                        alert('请选择查询类型');
                        return;
                    }
                    
                    const queryType = queryTypeElement.value;
                    const assetOwner = assetOwnerElement ? assetOwnerElement.value : '';
                    const systemId = systemIdElement ? systemIdElement.value : '';
                    
                    // 获取结果容器并显示
                    const queryResultsDiv = document.getElementById('customer-query-results');
                    const resultsContainerDiv = document.getElementById('customer-results-container');
                    
                    if (queryResultsDiv) {
                        queryResultsDiv.style.display = 'block';
                    }
                    
                    if (resultsContainerDiv) {
                        resultsContainerDiv.innerHTML = '<div style="text-align:center;padding:20px;">正在加载查询结果...</div>';
                    } else {
                        console.error('未找到结果容器元素');
                        return;
                    }
                    
                    // 构建查询参数
                    const params = new URLSearchParams();
                    params.append('query_type', queryType);
                    params.append('asset_owner', assetOwner);
                    if (systemId) params.append('system_id', systemId);
                    
                    console.log('正在执行客户查询:', params.toString());
                    
                    // 执行全局查询（使用与主页相同的API）
                    const apiUrl = `/api/global_query?${params.toString()}`;
                    console.log('请求URL:', apiUrl);
                    
                    fetch(apiUrl)
                        .then(response => {
                            console.log('API响应状态:', response.status);
                            if (!response.ok) {
                                throw new Error(`HTTP错误! 状态码: ${response.status}`);
                            }
                            return response.json();
                        })
                        .then(data => {
                            console.log('查询返回数据:', data);
                            if (!data) {
                                throw new Error('返回的数据为空');
                            }
                            displayCustomerQueryResults(data);
                        })
                        .catch(error => {
                            console.error('查询失败:', error);
                            resultsContainerDiv.innerHTML = `<div style="color:#e53e3e;padding:15px;">查询失败: ${error.message}</div>`;
                        });
                });
            }
            
            // 导出功能已移除
            
            // 保存更改功能
            const saveChangesBtn = document.getElementById('customer-save-changes');
            if (saveChangesBtn) {
                saveChangesBtn.addEventListener('click', function() {
                    const editedCells = document.querySelectorAll('td[data-edited="true"]');
                    if (editedCells.length === 0) {
                        alert('没有需要保存的修改');
                        return;
                    }
                    
                    // 收集修改数据
                    const changes = [];
                    editedCells.forEach(cell => {
                        changes.push({
                            system_id: cell.dataset.systemId,
                            yaml_path: cell.dataset.path,
                            new_value: cell.textContent
                        });
                    });
                    
                    // 发送保存请求
                    fetch('/api/update_yaml_fields', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({ changes: changes })
                    })
                    .then(response => response.json())
                    .then(data => {
                        if (data.success) {
                            alert('修改已保存');
                            // 清除已编辑标记
                            editedCells.forEach(cell => cell.removeAttribute('data-edited'));
                        } else {
                            alert('保存失败: ' + data.error);
                        }
                    })
                    .catch(error => {
                        alert('保存失败: ' + error.message);
                    });
                });
            }
        });
        
        // 显示客户查询结果
        function displayCustomerQueryResults(data) {
            console.log('准备显示客户查询结果:', data);
            const resultsContainerDiv = document.getElementById('customer-results-container');
            const queryResultsDiv = document.getElementById('customer-query-results');
            
            if (!resultsContainerDiv) {
                console.error('未找到客户查询结果容器');
                return;
            }
            
            // 显示查询结果区域
            if (queryResultsDiv) {
                queryResultsDiv.style.display = 'block';
            }
            
            // 处理错误情况
            if (data.error) {
                resultsContainerDiv.innerHTML = `<div style="color:#e53e3e;padding:15px;">查询错误: ${data.error}</div>`;
                return;
            }
            
            // 处理"所有查询"类型
            if (parseInt(data.query_type) === 0 && data.all_query_results) {
                console.log('处理所有查询类型结果');
                let allResultsHTML = '<h3 style="margin-bottom: 15px;">所有查询结果</h3>';
                
                for (const queryType in data.all_query_results) {
                    const queryResult = data.all_query_results[queryType];
                    queryResult.query_type = parseInt(queryType);
                    
                    let queryTypeName = '';
                    switch (parseInt(queryType)) {
                        case 1: queryTypeName = '设备数量统计'; break;
                        case 2: queryTypeName = 'SFA版本详情'; break;
                        case 3: queryTypeName = 'EXA版本详情'; break;
                        case 4: queryTypeName = 'BBU过期日期计算'; break;
                        case 5: queryTypeName = '集群容量查询'; break;
                        case 6: queryTypeName = '设备序列号查询'; break;
                        case 7: queryTypeName = '集群IP地址查询'; break;
                    }
                    
                    allResultsHTML += `<div style="margin-top: 30px;"><h4 style="margin-bottom: 10px;">${queryTypeName}</h4>`;
                    allResultsHTML += createCustomerQueryResultHTML(queryResult);
                    allResultsHTML += '</div>';
                }
                
                resultsContainerDiv.innerHTML = allResultsHTML;
            } else {
                // 单个查询类型的结果
                console.log('处理单个查询类型结果:', data.query_type);
                resultsContainerDiv.innerHTML = createCustomerQueryResultHTML(data);
            }
        }
        
        // 创建客户查询结果HTML
        function createCustomerQueryResultHTML(data) {
            console.log('开始创建查询结果HTML，数据类型:', data.query_type);
            
            // 如果数据为空，显示提示信息
            if (!data) {
                console.error('查询结果数据为空');
                return '<div style="padding:15px;text-align:center;color:#718096;">无查询结果数据</div>';
            }
            
            // 简单的表格风格 - 参照原始脚本输出
            let resultHtml = '<table style="width:100%; border-collapse:collapse; font-family:monospace;">';
            
            // 确定要显示哪些列
            let columns = [];
            let items = [];
            
            // 处理不同查询类型的数据结构
            if (data.query_type == 1) {
                // 设备数量统计
                columns = ["集群名称", "设备数量", "资产所有者"];
                if (data.clusters && data.clusters.length > 0) {
                    items = data.clusters.map(c => [
                        c.Cluster_name || '-',
                        c.Device_count || 0,
                        c.Asset_owner || '-'
                    ]);
                    // 添加总计行
                    if (data.total_devices) {
                        items.push(['总计', data.total_devices, '']);
                    }
                }
            } else if (data.query_type == 2) {
                // SFA版本详情
                columns = ["集群名称", "设备名称", "资产所有者", "SFA版本", "设备类型"];
                if (data.devices && data.devices.length > 0) {
                    items = data.devices.map(d => [
                        d.Cluster_name || '-',
                        d.Device_name || '-',
                        d.Asset_owner || '-',
                        d.SFA_version || '-',
                        d.Type || '-'
                    ]);
                }
            } else if (data.query_type == 3) {
                // EXA版本详情
                columns = ["集群名称", "资产所有者", "EXA版本"];
                if (data.clusters && data.clusters.length > 0) {
                    items = data.clusters.map(c => [
                        c.Cluster_name || '-',
                        c.Asset_owner || '-',
                        c.EXA_version || '-'
                    ]);
                }
            } else if (data.query_type == 4) {
                // BBU过期日期
                columns = ["集群名称", "设备名称", "资产所有者", "BBU1过期日期", "BBU1剩余天数", "BBU2过期日期", "BBU2剩余天数"];
                if (data.devices && data.devices.length > 0) {
                    items = data.devices.map(d => [
                        d.Cluster_name || '-',
                        d.Device_name || '-',
                        d.Asset_owner || '-',
                        d.BBU1_expiration || '-',
                        typeof d.BBU1_remaining_days === 'number' ? 
                          (d.BBU1_remaining_days >= 0 ? d.BBU1_remaining_days + ' 天' : '已过期 ' + (-d.BBU1_remaining_days) + ' 天') : '-',
                        d.BBU2_expiration || '-',
                        typeof d.BBU2_remaining_days === 'number' ? 
                          (d.BBU2_remaining_days >= 0 ? d.BBU2_remaining_days + ' 天' : '已过期 ' + (-d.BBU2_remaining_days) + ' 天') : '-'
                    ]);
                }
            } else if (data.query_type == 5) {
                // 集群容量查询
                columns = ["集群名称", "资产所有者", "网络端口类型", "容量"];
                if (data.clusters && data.clusters.length > 0) {
                    items = data.clusters.map(c => [
                        c.Cluster_name || '-',
                        c.Asset_owner || '-',
                        c.Network_port_type || '-',
                        c.Capacity || '-'
                    ]);
                }
            } else if (data.query_type == 6) {
                // 设备序列号查询
                columns = ["集群名称", "设备名称", "资产所有者", "控制器C0序列号", "控制器C1序列号"];
                if (data.devices && data.devices.length > 0) {
                    items = data.devices.map(d => [
                        d.Cluster_name || '-',
                        d.Device_name || '-',
                        d.Asset_owner || '-',
                        d.Controller_c0_serial_number || '-',
                        d.Controller_c1_serial_number || '-'
                    ]);
                }
            } else if (data.query_type == 7) {
                // 集群IP地址查询（包含主机IP信息）
                columns = ["集群名称", "设备名称", "资产所有者", "控制器C0 IP", "控制器C1 IP", "EMF IP", "主机名", "主机管理IP", "主机数据网络"];
                if (data.devices && data.devices.length > 0) {
                    items = data.devices.map(d => [
                        d.Cluster_name || '-',
                        d.Device_name || '-',
                        d.Asset_owner || '-',
                        d.Controller_c0_ip || '-',
                        d.Controller_c1_ip || '-',
                        d.EMF_ip || '-',
                        d.Host_name || '-',
                        d.Host_mgmt_ip || '-',
                        d.Host_data_networks || '-'
                    ]);
                }
            }
            
            // 构建表头
            resultHtml += '<tr>';
            columns.forEach(col => {
                resultHtml += `<th style="text-align:left;padding:8px;border-bottom:2px solid #e2e8f0;background:#f7fafc;">${col}</th>`;
            });
            resultHtml += '</tr>';
            
            // 构建表格内容
            if (items.length === 0) {
                resultHtml += `<tr><td colspan="${columns.length}" style="padding:10px;text-align:center;color:#718096;">没有找到符合条件的数据</td></tr>`;
            } else {
                items.forEach((row, rowIndex) => {
                    const rowStyle = rowIndex % 2 === 0 ? 'background:#f8fafc;' : '';
                    resultHtml += `<tr style="${rowStyle}">`;
                    row.forEach(cell => {
                        resultHtml += `<td style="padding:8px;border-bottom:1px solid #e2e8f0;">${cell}</td>`;
                    });
                    resultHtml += '</tr>';
                });
            }
            
            resultHtml += '</table>';
            
            // 版本统计摘要已移除
            
            return resultHtml;
        }
    </script>
</body>
</html>